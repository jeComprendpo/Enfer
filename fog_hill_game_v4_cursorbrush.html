<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fog Hill Village ‚Äî Version 4 (Cursor Brush)</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root{ --seal:#9c1e1e; --tile:72px; --shadow:rgba(0,0,0,.25); }
    html,body{ height:100%; margin:0; }
    body{
      font-family:"Noto Serif SC",serif;
      background:#f5f1e6;
      overflow:hidden;
      /* Curseur pinceau global (tailles 32 et 48 en fallback) */
      cursor: url('Image/cursor_brush_32.png') 7 7, url('Image/cursor_brush_48.png') 11 10, auto;
    }
    /* Forcer les √©l√©ments interactifs √† h√©riter du curseur */
    button, .menu-btn, .round-btn, .build-card, .buildings-layer, .grid-layer, .ghost, .world { cursor: inherit !important; }
    /* Header minimal */
    .header{ position:fixed; top:0; left:0; right:0; height:44px; background:rgba(255,255,255,.9); border-bottom:2px solid var(--seal); display:flex; align-items:center; justify-content:space-between; padding:0 10px; z-index:40; }
    .round-btn{ width:36px; height:36px; border-radius:50%; border:2px solid var(--seal); background:#fff; display:flex; align-items:center; justify-content:center; font-size:18px; }
    .round-btn:hover{ background:var(--seal); color:#fff; }
    .res-bar{ display:flex; align-items:center; gap:10px; }
    .res-chip{ background:rgba(255,255,255,.8); border:1px solid #00000025; border-radius:999px; padding:2px 8px; box-shadow:0 1px 3px var(--shadow); font-size:14px; }
    /* Floating stats menu */
    .stats-menu{ position:absolute; top:50px; left:10px; background:rgba(255,255,255,.95); border:2px solid var(--seal); border-radius:8px; padding:10px; display:none; flex-direction:column; gap:6px; min-width:220px; z-index:60; }
    .stats-menu.open{ display:flex; }
    .stats-menu h4{ margin:4px 0; font-size:14px; }
    /* World */
    .game-wrap{ position:fixed; top:44px; bottom:60px; left:0; right:0; }
    .world{ position:relative; width:100%; height:100%; background:url('Image/a.png') center/cover no-repeat; overflow:hidden; }
    .grid-layer,.buildings-layer,.ghost{ position:absolute; inset:0; }
    .grid-layer.show{ background-image:linear-gradient(#00000015 1px,transparent 1px),linear-gradient(90deg,#00000015 1px,transparent 1px); background-size:var(--tile) var(--tile); }
    .building{ position:absolute; width:var(--tile); height:var(--tile); filter:drop-shadow(0 2px 4px rgba(0,0,0,.3)); }
    .building[data-type="pavillon"]{ background:url('Image/Maison.png') center/contain no-repeat }
    .building[data-type="riziere"]{ background:url('Image/Maison2.png') center/contain no-repeat }
    .building[data-type="the"]{ background:url('Image/Temple.png') center/contain no-repeat }
    .building[data-type="bambou"]{ background:url('Image/Boutique.png') center/contain no-repeat }
    .building[data-type="encens"]{ background:url('Image/forge.png') center/contain no-repeat }
    .building[data-type="autel"]{ background:url('Image/templePetit.png') center/contain no-repeat }
    .ghost{ pointer-events:none; border:2px dashed #000; background:rgba(0,0,0,.1); opacity:.7; width:var(--tile); height:var(--tile); }
    /* Footer compact with category buttons */
    .footer{ position:fixed; bottom:0; left:0; right:0; height:60px; background:rgba(255,255,255,.9); border-top:2px solid var(--seal); display:flex; justify-content:center; align-items:center; gap:14px; z-index:50; }
    .menu-btn{ width:44px; height:44px; border-radius:50%; border:2px solid var(--seal); background:#fff; font-size:20px; display:flex; align-items:center; justify-content:center; }
    .menu-btn:hover{ background:var(--seal); color:#fff; }
    /* Floating build menus */
    .build-menu{ position:absolute; bottom:70px; background:rgba(255,255,255,.95); border:2px solid var(--seal); border-radius:8px; padding:6px; display:none; gap:8px; }
    .build-menu.open{ display:flex; }
    .build-card{ border:1px solid #00000025; border-radius:6px; background:#fff; padding:6px; text-align:center; min-width:100px; font-size:12px; }
    .build-card:hover{ background:var(--seal); color:#fff; }
    /* Toasts */
    .toast{ position:fixed; top:50px; right:10px; background:var(--seal); color:#fff; padding:6px 12px; border-radius:999px; box-shadow:0 2px 6px rgba(0,0,0,.3); animation:fadein .2s; z-index:80; }
    @keyframes fadein{ from{opacity:0;transform:translateY(-4px)} to{opacity:1;transform:translateY(0)} }
  </style>
</head>
<body>
<header class="header">
  <button class="round-btn" id="statBtn">üìä</button>
  <div class="res-bar">
    <div class="res-chip">üå≤ <span id="r-bois">50</span></div>
    <div class="res-chip">üåæ <span id="r-riz">20</span></div>
    <div class="res-chip">üçµ <span id="r-the">10</span></div>
    <div class="res-chip">ü™î <span id="r-encens">5</span></div>
    <div class="res-chip">üôè <span id="r-croyance">15</span></div>
    <div class="res-chip">üë• <span id="r-villagers">5</span></div>
  </div>
</header>
<div class="stats-menu" id="statsMenu">
  <h4>√âl√©ments</h4><div id="elemList"></div>
  <h4>Corruption</h4><div id="corrInfo">0%</div>
  <h4>Saison</h4><div id="seasonInfo">Printemps, Jour 1</div>
  <h4>Villageois</h4><ul id="villagerList"></ul>
</div>
<main class="game-wrap">
  <section class="world" id="world">
    <div class="grid-layer" id="grid"></div>
    <div class="buildings-layer" id="layer"></div>
    <div class="ghost" id="ghost" style="display:none;"></div>
  </section>
</main>
<footer class="footer">
  <button class="menu-btn" data-menu="menu1">üè†</button>
  <button class="menu-btn" data-menu="menu2">‚öí</button>
  <button class="menu-btn" data-menu="menu3">üèõ</button>
</footer>
<!-- Floating build menus -->
<div class="build-menu" id="menu1">
  <div class="build-card" data-type="pavillon">Pavillon<br><span class="meta">10 Bois</span></div>
  <div class="build-card" data-type="riziere">Rizi√®re<br><span class="meta">5 Bois</span></div>
  <div class="build-card" data-type="the">Th√©<br><span class="meta">5 Bois</span></div>
</div>
<div class="build-menu" id="menu2">
  <div class="build-card" data-type="bambou">Bambou<br><span class="meta">0</span></div>
  <div class="build-card" data-type="encens">Encens<br><span class="meta">8 Bois</span></div>
</div>
<div class="build-menu" id="menu3">
  <div class="build-card" data-type="autel">Autel<br><span class="meta">6 Bois,5 Th√©</span></div>
</div>
<script>
// ===== √âtat du jeu =====
const resources={bois:50,riz:20,the:10,encens:5,croyance:15,villagers:5};
const harmony={feu:50,eau:50,bois:50,metal:50,terre:50};
let corruption=0, day=1, seasonIndex=0; const seasons=['Printemps','√ât√©','Automne','Hiver'];
const villagers=Array.from({length:resources.villagers},(_,i)=>{const elems=['feu','eau','bois','metal','terre'];return {id:i+1,name:'Disciple '+(i+1),elem:elems[Math.floor(Math.random()*elems.length)],sanity:100,assigned:null};});
// ===== UI =====
function refreshUI(){
  document.getElementById('r-bois').textContent=resources.bois;
  document.getElementById('r-riz').textContent=resources.riz;
  document.getElementById('r-the').textContent=resources.the;
  document.getElementById('r-encens').textContent=resources.encens;
  document.getElementById('r-croyance').textContent=resources.croyance;
  document.getElementById('r-villagers').textContent=resources.villagers;
  document.getElementById('elemList').innerHTML=Object.entries(harmony).map(function(p){return p[0]+': '+Math.round(p[1]);}).join('<br>');
  document.getElementById('corrInfo').textContent=Math.round(corruption)+'%';
  document.getElementById('seasonInfo').textContent=seasons[seasonIndex]+', Jour '+day;
  document.getElementById('villagerList').innerHTML=villagers.map(function(v){return '<li>'+v.name+' ‚Äî <i>'+v.elem+'</i> ‚Äî Sanit√©: '+Math.round(v.sanity)+' '+(v.assigned?('‚Üí '+v.assigned.type):'')+'</li>';}).join('');
}
refreshUI();
// menu stats
document.getElementById('statBtn').addEventListener('click',function(){document.getElementById('statsMenu').classList.toggle('open');});
// Toast
function toast(msg){var el=document.createElement('div');el.className='toast';el.textContent=msg;document.body.appendChild(el);setTimeout(function(){el.remove();},2000);}
// ===== Placement =====
const TILE=72; const world=document.getElementById('world'); const layer=document.getElementById('layer'); const ghost=document.getElementById('ghost'); let selectedType=null;
document.querySelectorAll('.menu-btn').forEach(function(btn){btn.addEventListener('click',function(){const id=btn.dataset.menu;document.querySelectorAll('.build-menu').forEach(function(m){m.classList.remove('open');});const menu=document.getElementById(id);menu.classList.toggle('open');menu.style.left=btn.getBoundingClientRect().left+'px';});});
document.querySelectorAll('.build-card').forEach(function(card){card.addEventListener('click',function(){selectedType=card.dataset.type;ghost.style.display='block';toast(selectedType+' s√©lectionn√©');document.querySelectorAll('.build-menu').forEach(function(m){m.classList.remove('open');});});});
world.addEventListener('contextmenu',function(e){e.preventDefault();selectedType=null;ghost.style.display='none';});
world.addEventListener('mousemove',function(e){if(!selectedType) return;const rect=world.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;ghost.style.left=Math.floor(x/TILE)*TILE+'px';ghost.style.top=Math.floor(y/TILE)*TILE+'px';});
world.addEventListener('click',function(e){if(!selectedType) return;const el=document.createElement('div');el.className='building';el.dataset.type=selectedType;el.style.left=ghost.style.left;el.style.top=ghost.style.top;layer.appendChild(el);selectedType=null;ghost.style.display='none';toast('B√¢timent plac√©');});
// ===== Corruption & Saisons =====
function clamp(v,min,max){return Math.max(min,Math.min(max,v));}
function avgOffBalance(){const vals=Object.values(harmony).map(function(v){return Math.abs(50-v);});return vals.reduce(function(a,b){return a+b;},0)/vals.length;}
function nextDay(){day++;if(day%10===0){seasonIndex=(seasonIndex+1)%seasons.length;toast('Nouvelle saison: '+seasons[seasonIndex]);}}
setInterval(function(){corruption=clamp(corruption+avgOffBalance()*0.02,0,100);nextDay();refreshUI();},4000);
// ===== Rituel (touche R) =====
document.addEventListener('keydown',function(e){if(e.key==='r'){if(resources.encens>=2&&resources.croyance>=3){resources.encens-=2;resources.croyance-=3;corruption=clamp(corruption-10,0,100);toast('Rituel accompli');refreshUI();}else{toast("Pas assez de ressources pour le rituel");}}});
</script>
</body>
</html>
